/* https://www.github.com/jas-/jQuery.pidCrypt */
(function(a){a.fn.pidCrypt=function(c){var f=f||{appID:"",storage:"local",formID:a(this),type:"json",aes:"",keys:{},use:"",callback:function(){},preCallback:function(){},errCallback:function(){}};var e=e||{init:function(m){var l=d.__setup(m,f);a("body").removeData("use");b.__setup(l);a("#keyring").change(function(){a("body").data("use",b.__e(l,a(this).val()));l=d.__setup(m,f)});a("#"+l.formID.attr("id")).on("submit",function(n){n.preventDefault();d.__do(l,d.__gF(l))});return true}};var d=d||{__do:function(n,l){var m=(typeof l=="object")?k.__serialize(l):l;a.ajax({form:n.formID.attr("id"),url:n.formID.attr("action"),type:n.formID.attr("method"),data:m,crossDomain:(n.type==="jsonp")?true:false,beforeSend:function(o){o.setRequestHeader("X-Alt-Referer",n.appID);if(i.__vStr(m)){o.setRequestHeader("Content-MD5",pidCryptUtil.encodeBase64(pidCrypt.MD5(m)))}else{o.setRequestHeader("Content-MD5",pidCryptUtil.encodeBase64(pidCrypt.MD5(n.appID)))}((n.preCallback)&&(a.isFunction(n.preCallback)))?n.preCallback(o):false},success:function(o,p,q){(o)?j.__hR(o,n):false;((n.callback)&&(a.isFunction(n.callback)))?n.callback.call(o):console.log(o)},error:function(q,o,p){((n.errCallback)&&(a.isFunction(n.errCallback)))?n.errCallback.call(q,o,p):false}})},__setup:function(n,m){var l=a.extend({},m,n);l.aes=h.__sAES();l.keys=j.__existing(l);l.appID=(i.__vStr(l.appID))?l.appID:j.__gUUID(null);if(i.__szCk(l.keys)<=0){j.__hK(l)}l.use=(a("body").data("use"))?a("body").data("use"):j.__sK(l);return l},__gF:function(m){var l={};if(!i.__vStr(m.use)){m=d.__setup(m,f)}a.each(a("#"+m.formID.attr("id")+" :input, input:radio:selected, input:checkbox:checked, textarea"),function(o,n){if((i.__vStr(n.value))&&(i.__vStr(n.name))){l[n.name]=(parseInt(n.value.length)>80)?k.__sSplt(n.value):n.value}});return h.__eO(m,l)}};var j=j||{__hK:function(l){var m=function(){var q=(this)?JSON.parse(this):false;var n=((q)&&(q.email))?q.email:l.appID;var o=((q)&&(q.key))?q.key:false;if(!o){return false}var p={};p[l.appID]={};p[l.appID]["email"]=h.__e(l.aes,n,l.appID);p[l.appID]["key"]=h.__e(l.aes,o,l.appID);p=a.extend({},p,j.__existing(l));g.__sI(l.storage,j.__id(),JSON.stringify(p))};l.callback=m;d.__do(l,{key:true});return true},__sK:function(m){var l=false;if(i.__szCk(m.keys)>0){a.each(m.keys,function(p,o){var q=/[0-9a-z-_.]{2,45}\@[0-9a-z-_.]{2,45}\.[a-z]{2,4}/i;var n=h.__d(m.aes,o.email,p);if(q.test(n)){l=h.__d(m.aes,o.key,p);return false}else{l=h.__d(m.aes,o.key,p)}})}return l},__existing:function(l){return(g.__gI(l.storage,j.__id()))?JSON.parse(g.__gI(l.storage,j.__id())):false},__id:function(){return(i.__vStr(location.host))?location.host:(i.__vStr(location.hostname))?location.hostname:"localhost"},__gUUID:function(l){var q="0123456789abcdef".split("");var o=[],n=Math.random,p;o[8]=o[13]=o[18]=o[23]="-";o[14]="4";for(var m=0;m<36;m++){if(!o[m]){p=0|n()*16;o[m]=q[(m==19)?(p&3)|8:p&15]}}return(l!==null)?o.join("").replace(/-/g,"").split("",l).join(""):o.join("")},__strIV:function(l){return(l)?encodeURI(l.replace(/-/gi,"").substring(16,Math.ceil(16*l.length)%l.length)):false},__hR:function(m,n){var l=false;if(i.__szCk(m)>0){a.each(JSON.parse(m),function(p,o){if((p==="keyring")&&(i.__vStr(o.email))){if(!j.__hlpr(n,o.email)){var q=j.__gUUID(null);var r={};r[q]={};r[q]["email"]=h.__e(n.aes,o.email,q);r[q]["key"]=h.__e(n.aes,o.key,q);r=a.extend({},r,j.__existing(n));g.__sI(n.storage,j.__id(),JSON.stringify(r))}}})}return l},__hlpr:function(n,l){var m=false;a.each(j.__existing(n),function(p,o){if(h.__d(n.aes,o.email,p)==l){m=true}});return m}};var h=h||{__eO:function(n,m){var l={};var p=h.__certParser(n.use);h.__iP(p);if(i.__szCk(m)>0){a.each(m,function(q,o){if(typeof o==="object"){l[q]={};a.each(o,function(s,r){l[q][s]=pidCrypt.RSA.prototype.encrypt(r)})}else{l[q]=pidCrypt.RSA.prototype.encrypt(o)}})}else{l=0}return l},__sAES:function(){return new pidCrypt.AES.CBC()},__iP:function(p){var o=false;if(p.b64){var m=pidCryptUtil.decodeBase64(p.b64);o=new pidCrypt();var n=pidCrypt.ASN1.decode(pidCryptUtil.toByteArray(m));var l=n.toHexTree();pidCrypt.RSA.prototype.setPublicKeyFromASN(l)}return o},__certParser:function(q){if(!q){return false}var v=q.split("\n");var l=false;var m=false;var n=false;var s="";var o={};o.info="";o.salt="";o.iv;o.b64="";o.aes=false;o.mode="";o.bits=0;for(var r=0;r<v.length;r++){s=v[r].substr(0,9);if(r==1&&s!="Proc-Type"&&s.indexOf("M")==0){m=true}switch(s){case"-----BEGI":l=true;break;case"Proc-Type":if(l){o.info=v[r]}break;case"DEK-Info:":if(l){var p=v[r].split(",");var u=p[0].split(": ");var t=u[1].split("-");o.aes=(t[0]=="AES")?true:false;o.mode=t[2];o.bits=parseInt(t[1]);o.salt=p[1].substr(0,16);o.iv=p[1]}break;case"":if(l){m=true}break;case"-----END ":if(l){m=false;l=false}break;default:if(l&&m){o.b64+=pidCryptUtil.stripLineFeeds(v[r])}}}return o},__e:function(n,m,l){return encodeURI(n.encryptText(m,pidCrypt.SHA512(l),{nBits:256,salt:j.__strIV(pidCrypt.SHA512(l))}))},__d:function(n,m,l){return decodeURI(n.decryptText(m,pidCrypt.SHA512(l),{nBits:256,salt:j.__strIV(pidCrypt.SHA512(l))}))}};var k=k||{__serialize:function(m){if(i.__szCk(m)>0){var l="";a.each(m,function(o,n){if(typeof n==="object"){a.each(n,function(q,p){l+=o+"["+q+"]="+p+"&"})}else{l+=o+"="+n+"&"}});l=l.substring(0,l.length-1)}else{return false}return l},__sSplt:function(p){var n=p.length/80;var q={};var l=0;var o=80;for(var m=0;m<n;m++){if(m>0){l=l+80;o=o+80}if(p.slice(l,o).length>0){q[m]=p.slice(l,o)}}return q}};var g=g||{__sI:function(o,n,m){var l=false;o=(i.__vStore(o+"Storage"))?o:"cookie";switch(o){case"local":l=this.__sL(n,m);break;case"session":l=this.__sS(n,m);break;case"cookie":l=this.__sC(n,m);break;default:l=this.__sL(n,m);break}return l},__gI:function(n,m){var l=false;n=(i.__vStore(n+"Storage"))?n:"cookie";switch(n){case"local":l=this.__gL(m);break;case"session":l=this.__gS(m);break;case"cookie":l=this.__gC(m);break;default:l=this.__gL(m);break}return l},__dI:function(n,m){var l=false;n=(i.__vStore(n+"Storage"))?n:"cookie";switch(n){case"local":l=this.__dL(m);break;case"session":l=this.__dS(m);break;case"cookie":l=this.__dC(m);break;default:l=this.__dL(m);break}return l},__sL:function(m,l){return(localStorage.setItem(m,l))?false:true},__sS:function(m,l){return(sessionStorage.setItem(m,l))?false:true},__sC:function(m,l){if(typeof a.cookie==="function"){return(a.cookie(m,l,{expires:7}))?true:false}else{return false}},__gL:function(l){return(localStorage.getItem(l))?localStorage.getItem(l):false},__gS:function(l){return(sessionStorage.getItem(l))?sessionStorage.getItem(l):false},__gC:function(l){if(typeof a.cookie==="function"){return(a.cookie(l))?a.cookie(l):false}else{return false}},__dL:function(l){return(localStorage.removeItem(l))?localStorage.removeItem(l):false},__dS:function(l){return(sessionStorage.removeItem(l))?sessionStorage.removeItem(l):false},__dC:function(l){if(typeof a.cookie==="function"){return(a.cookie(l,"",{expires:-7}))?true:false}else{return false}}};var i=i||{__vStr:function(l){return((l==false)||(l.length==0)||(!l)||(l==null)||(l=="")||(typeof l=="undefined"))?false:true},__vStore:function(l){try{return((l in window)&&(window[l]))?true:false}catch(m){return false}},__szCk:function(l){var m=0;a.each(l,function(o,n){if(l.hasOwnProperty(o)){m++}});return m}};var b=b||{__setup:function(m){if(i.__szCk(m.keys)>=3){var l='<div id="overlay"></div><div id="modal"><div id="content">'+b.__aK(m)+"</div></div>";a("#"+m.formID.attr("name")).prepend(l);a("body").css({overflow:"hidden"});a("#overlay").css({position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"#000",opacity:0.5,filter:"alpha(opacity=50)"});a("#modal").css({position:"absolute",background:"rgba(0,0,0,0.2)","border-radius":"14px",padding:"8px"});a("#content").css({"border-radius":"8px",background:"#fff",padding:"20px"})}},__e:function(m,l){a.each(m.keys,function(o,n){if(h.__d(m.aes,n.email,o)==l){m.use=h.__d(m.aes,n.key,o);a("#keyring, #content, #modal, #overlay").hide();a("body").css({overflow:"auto"})}});return m.use},__aK:function(r){var q=i.__szCk(r.keys);var l=(q>=5)?5:q;var m,n="";if(q>=3){var p="";m='<label for="keyring">Select your email:</label><select name="keyring" id="keyring" size="'+l+'" multiple>';a.each(r.keys,function(s,o){p=h.__d(r.aes,o.email,s);n=/[0-9a-z-_.]{2,45}\@[0-9a-z-_.]{2,45}\.[a-z]{2,4}/i;if(n.test(p)){m=m+'<option value="'+p+'">'+p+"</option>"}});m=m+"</select>"}return m}};if(e[c]){return e[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if((typeof c==="object")||(!c)){return e.init.apply(this,arguments)}else{console.log("Method "+c+" does not exist")}}}})(jQuery);
//(function(a){a.fn.pidCrypt=function(b){var e=e||{appID:"jQuery.pidCrypt",storage:"local",formID:a(this),type:"json",aes:"",keys:{},use:"",callback:function(){},preCallback:function(){},errCallback:function(){}};var d=d||{init:function(l){var k=c.__setup(l,e);a("#"+k.formID.attr("id")).on("submit",function(m){m.preventDefault();c.__do(k,c.__gF(k))});return true}};var c=c||{__do:function(m,k){var l=(typeof k=="object")?j.__serialize(k):k;a.ajax({form:m.formID.attr("id"),url:m.formID.attr("action"),type:m.formID.attr("method"),data:l,crossDomain:(m.type==="jsonp")?true:false,beforeSend:function(n){n.setRequestHeader("X-Alt-Referer",m.appID);if(h.__vStr(l)){n.setRequestHeader("Content-MD5",pidCryptUtil.encodeBase64(pidCrypt.MD5(l)))}else{n.setRequestHeader("Content-MD5",pidCryptUtil.encodeBase64(pidCrypt.MD5(m.appID)))}((m.preCallback)&&(a.isFunction(m.preCallback)))?m.preCallback(n):false},success:function(n,o,p){((m.callback)&&(a.isFunction(m.callback)))?m.callback.call(n):console.log(n)},error:function(p,n,o){((m.errCallback)&&(a.isFunction(m.errCallback)))?m.errCallback.call(p,n,o):false}})},__setup:function(m,l){var k=a.extend({},l,m);k.aes=g.__sAES();k.keys=i.__existing(k);if(h.__szCk(k.keys)<=0){i.__hK(k)}k.use=i.__sK(k);return k},__gF:function(l){var k={};if(!h.__vStr(l.use)){l=c.__setup(l,e)}a.each(a("#"+l.formID.attr("id")+" :input, input:radio:selected, input:checkbox:checked, textarea"),function(n,m){if((h.__vStr(m.value))&&(h.__vStr(m.name))){k[m.name]=(parseInt(m.value.length)>80)?j.__sSplt(m.value):m.value}});return g.__eO(l,k)}};var i=i||{__hK:function(k){var l=function(){var r=(this)?JSON.parse(this):false;var m=((r)&&(r.email))?r.email:k.appID;var n=((r)&&(r.key))?r.key:false;if(!n){return false}var q=i.__gUUID(null);var o={};o[q]={};o[q]["email"]=encodeURI(k.aes.encryptText(m,q,{nBits:256,salt:i.__strIV(q)}));o[q]["key"]=encodeURI(k.aes.encryptText(n,q,{nBits:256,salt:i.__strIV(q)}));o=a.extend({},o,i.__existing(k));f.__sI(k.storage,i.__id(),JSON.stringify(o))};k.callback=l;c.__do(k,{key:true});return true},__sK:function(l){var k=false;if(h.__szCk(l.keys)>0){a.each(l.keys,function(o,n){var p=new RegExp("/[0-9a-z-_.]{2,45}@[0-9a-z-_.]{2,45}.[a-z]{2,4}/gi");var m=l.aes.decryptText(decodeURI(n.email),o,{nBits:256,salt:i.__strIV(o)});if(p.test(m)){return l.aes.decryptText(decodeURI(n.key),o,{nBits:256,salt:i.__strIV(o)})}else{k=l.aes.decryptText(decodeURI(n.key),o,{nBits:256,salt:i.__strIV(o)})}})}return k},__existing:function(k){return(f.__gI(k.storage,i.__id()))?JSON.parse(f.__gI(k.storage,i.__id())):false},__id:function(){return(h.__vStr(location.host))?location.host:(h.__vStr(location.hostname))?location.hostname:"localhost"},__gUUID:function(k){var p="0123456789abcdef".split("");var n=[],m=Math.random,o;n[8]=n[13]=n[18]=n[23]="-";n[14]="4";for(var l=0;l<36;l++){if(!n[l]){o=0|m()*16;n[l]=p[(l==19)?(o&3)|8:o&15]}}return(k!==null)?n.join("").replace(/-/g,"").split("",k).join(""):n.join("")},__strIV:function(k){return(k)?encodeURI(k.replace(/-/gi,"").substring(16,Math.ceil(16*k.length)%k.length)):false}};var g=g||{__eO:function(m,l){var k={};var n=g.__certParser(m.use);g.__iP(n);if(h.__szCk(l)>0){a.each(l,function(p,o){if(typeof o==="object"){k[p]={};a.each(o,function(r,q){k[p][r]=pidCrypt.RSA.prototype.encrypt(q)})}else{k[p]=pidCrypt.RSA.prototype.encrypt(o)}})}else{k=0}return k},__sAES:function(){return new pidCrypt.AES.CBC()},__iP:function(o){var n=false;if(o.b64){var l=pidCryptUtil.decodeBase64(o.b64);n=new pidCrypt();var m=pidCrypt.ASN1.decode(pidCryptUtil.toByteArray(l));var k=m.toHexTree();pidCrypt.RSA.prototype.setPublicKeyFromASN(k)}return n},__certParser:function(p){if(!p){return false}var u=p.split("\n");var k=false;var l=false;var m=false;var r="";var n={};n.info="";n.salt="";n.iv;n.b64="";n.aes=false;n.mode="";n.bits=0;for(var q=0;q<u.length;q++){r=u[q].substr(0,9);if(q==1&&r!="Proc-Type"&&r.indexOf("M")==0){l=true}switch(r){case"-----BEGI":k=true;break;case"Proc-Type":if(k){n.info=u[q]}break;case"DEK-Info:":if(k){var o=u[q].split(",");var t=o[0].split(": ");var s=t[1].split("-");n.aes=(s[0]=="AES")?true:false;n.mode=s[2];n.bits=parseInt(s[1]);n.salt=o[1].substr(0,16);n.iv=o[1]}break;case"":if(k){l=true}break;case"-----END ":if(k){l=false;k=false}break;default:if(k&&l){n.b64+=pidCryptUtil.stripLineFeeds(u[q])}}}return n}};var j=j||{__serialize:function(l){if(h.__szCk(l)>0){var k="";a.each(l,function(n,m){if(typeof m==="object"){a.each(m,function(p,o){k+=n+"["+p+"]="+o+"&"})}else{k+=n+"="+m+"&"}});k=k.substring(0,k.length-1)}else{return false}return k},__sSplt:function(o){var m=o.length/80;var p={};var k=0;var n=80;for(var l=0;l<m;l++){if(l>0){k=k+80;n=n+80}if(o.slice(k,n).length>0){p[l]=o.slice(k,n)}}return p}};var f=f||{__sI:function(o,n,m){var l=false;o=(h.__vStore(o+"Storage"))?o:"cookie";switch(o){case"local":l=this.__sL(n,m);break;case"session":l=this.__sS(n,m);break;case"cookie":l=this.__sC(n,m);break;default:l=this.__sL(n,m);break}return l},__gI:function(n,m){var l=false;n=(h.__vStore(n+"Storage"))?n:"cookie";switch(n){case"local":l=this.__gL(m);break;case"session":l=this.__gS(m);break;case"cookie":l=this.__gC(m);break;default:l=this.__gL(m);break}return l},__dI:function(n,m){var l=false;n=(h.__vStore(n+"Storage"))?n:"cookie";switch(n){case"local":l=this.__dL(m);break;case"session":l=this.__dS(m);break;case"cookie":l=this.__dC(m);break;default:l=this.__dL(m);break}return l},__sL:function(m,l){return(localStorage.setItem(m,l))?false:true},__sS:function(m,l){return(sessionStorage.setItem(m,l))?false:true},__sC:function(m,l){if(typeof a.cookie==="function"){return(a.cookie(m,l,{expires:7}))?true:false}else{return false}},__gL:function(l){return(localStorage.getItem(l))?localStorage.getItem(l):false},__gS:function(l){return(sessionStorage.getItem(l))?sessionStorage.getItem(l):false},__gC:function(k){if(typeof a.cookie==="function"){return(a.cookie(k))?a.cookie(k):false}else{return false}},__dL:function(l){return(localStorage.removeItem(l))?localStorage.removeItem(l):false},__dS:function(l){return(sessionStorage.removeItem(l))?sessionStorage.removeItem(l):false},__dC:function(k){if(typeof a.cookie==="function"){return(a.cookie(k,"",{expires:-7}))?true:false}else{return false}}};var h=h||{__vStr:function(k){return((k===false)||(k.length===0)||(!k)||(k===null)||(k==="")||(typeof k==="undefined"))?false:true},__vStore:function(k){try{return((k in window)&&(window[k]))?true:false}catch(l){return false}},__szCk:function(k){var l=0;a.each(k,function(n,m){if(k.hasOwnProperty(n)){l++}});return l}};if(d[b]){return d[b].apply(this,Array.prototype.slice.call(arguments,1))}else{if((typeof b==="object")||(!b)){return d.init.apply(this,arguments)}else{console.log("Method "+b+" does not exist")}}}})(jQuery);